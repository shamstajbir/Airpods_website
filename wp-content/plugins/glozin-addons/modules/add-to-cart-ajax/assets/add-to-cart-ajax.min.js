(function (u) {
  "use strict";
  function a() {
    u(document).on("click", ".single_add_to_cart_button", function (a) {
      var i = u(this),
        s = i.closest("form.cart"),
        d = i;
      if (i.hasClass("single_add_to_cart_button")) {
        if (i.closest(".product").hasClass("product-type-external")) {
          return;
        }
        if (s.hasClass("buy-now-clicked")) {
          d = s.find(".gz-buy-now-button");
        }
      }
      if (i.is(".disabled")) {
        return;
      }
      if (s.length > 0) {
        a.preventDefault();
      } else {
        return;
      }
      if (i.data("requestRunning")) {
        return;
      }
      i.data("requestRunning", true);
      var l = false;
      i.removeClass("added");
      d.addClass("loading");
      if (l) {
        return;
      }
      l = true;
      if (
        false ===
        u(document.body).triggerHandler(
          "should_send_ajax_request.adding_to_cart",
          [i]
        )
      ) {
        u(document.body).trigger("ajax_request_not_sent.adding_to_cart", [
          false,
          false,
          i,
        ]);
        return true;
      }
      var e = s.serializeArray(),
        c = s.attr("action");
      var t = {};
      if (i.hasClass("single_add_to_cart_button")) {
        u.each(e, function (a, e) {
          if (e["name"] == "add-to-cart") {
            if (e["value"]) {
              t["glozin-add-to-cart-ajax"] = e["value"];
            }
          } else {
            t[e["name"]] = e["value"];
          }
        });
        if (t["glozin-add-to-cart-ajax"] == undefined) {
          t["glozin-add-to-cart-ajax"] = i.val();
          e.push({ name: "add-to-cart", value: i.val() });
        }
      }
      u(document.body).trigger("adding_to_cart", [i, e]);
      var n = "";
      if (typeof glozinData !== "undefined") {
        n = glozinData.ajax_url;
      } else if (typeof wc_add_to_cart_params !== "undefined") {
        n = wc_add_to_cart_params.wc_ajax_url;
      }
      if (!n) {
        return;
      }
      u(document.body).trigger("glozin_progress_bar_start");
      u.ajax({
        url: n
          .toString()
          .replace("%%endpoint%%", "glozin_add_to_cart_single_ajax"),
        method: "post",
        data: t,
        error: function (a) {
          window.location = c;
        },
        success: function (a) {
          if (!a) {
            window.location = c;
          }
          if (a.url) {
            s.removeClass("buy-now-clicked");
            i.data("requestRunning", false);
            d.removeClass("loading");
            u(document.body).trigger("glozin_progress_bar_complete");
            window.location = a.url;
            return;
          }
          if (!a.error) {
            u(document.body).trigger("added_to_cart", [
              a.fragments,
              a.cart_hash,
              i,
            ]);
          } else {
            d.removeClass("loading");
          }
          if (u.fn.notify && a.error) {
            var e =
                '<span class="glozin-svg-icon message-icon"><svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="50px" height="50px"><path d="M 25 2 C 12.309295 2 2 12.309295 2 25 C 2 37.690705 12.309295 48 25 48 C 37.690705 48 48 37.690705 48 25 C 48 12.309295 37.690705 2 25 2 z M 25 4 C 36.609824 4 46 13.390176 46 25 C 46 36.609824 36.609824 46 25 46 C 13.390176 46 4 36.609824 4 25 C 4 13.390176 13.390176 4 25 4 z M 25 11 A 3 3 0 0 0 22 14 A 3 3 0 0 0 25 17 A 3 3 0 0 0 28 14 A 3 3 0 0 0 25 11 z M 21 21 L 21 23 L 22 23 L 23 23 L 23 36 L 22 36 L 21 36 L 21 38 L 22 38 L 23 38 L 27 38 L 28 38 L 29 38 L 29 36 L 28 36 L 27 36 L 27 21 L 26 21 L 22 21 L 21 21 z"/></svg></span>',
              t =
                '<span class="glozin-svg-icon svg-active"><svg class="svg-icon" aria-hidden="true" role="img" focusable="false" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1 14M1 1L14 14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg></span>',
              n = "error",
              r = a.error,
              o =
                '<a href="' +
                glozinATCA.view_cart_link +
                '" class="btn-button">' +
                glozinATCA.view_cart_text +
                "</a>";
            u.notify.addStyle("glozin", {
              html:
                "<div>" +
                e +
                '<div class="message-box">' +
                r +
                "</div>" +
                t +
                "</div>",
            });
            u.notify("&nbsp", {
              autoHideDelay: 5e3,
              className: n,
              style: "glozin",
              showAnimation: "fadeIn",
              hideAnimation: "fadeOut",
            });
          }
          u(document.body).trigger("glozin_progress_bar_complete");
          i.data("requestRunning", false);
          l = false;
        },
      });
    });
  }
  u(function () {
    if (!glozinATCA) {
      return;
    }
    if (glozinATCA.add_to_cart_ajax !== "yes") {
      return;
    }
    a();
  });
})(jQuery);
